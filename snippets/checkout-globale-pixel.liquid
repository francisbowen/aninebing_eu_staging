// These are already all included in the international checkout from theme.liquid

// General
// Google Tag Manager
(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-MTX78V9');
// End Google Tag Manager

// Start Hotjar Tracking
(function(h,o,t,j,a,r){
  h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
  h._hjSettings={hjid:1645072,hjsv:6};
  a=o.getElementsByTagName('head')[0];
  r=o.createElement('script');r.async=1;
  r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
  a.appendChild(r);
})(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
// End Hotjar Tracking

// Start Pixel Heap
// REQUIRE {{ checkout.email }}
window.heap=window.heap||[],heap.load=function(e,t){window.heap.appid=e,window.heap.config=t=t||{};var r=t.forceSSL||"https:"===document.location.protocol,a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src=(r?"https:":"http:")+"//cdn.heapanalytics.com/js/heap-"+e+".js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(a,n);for(var o=function(e){return function(){heap.push([e].concat(Array.prototype.slice.call(arguments,0)))}},p=["addEventProperties","addUserProperties","clearEventProperties","identify","removeEventProperty","setEventProperties","track","unsetEventProperty"],c=0;c<p.length;c++)heap[p[c]]=o(p[c])};
heap.load("148200200");

{% if customer %}   
  heap.addEventProperties({'Order Count': {{ customer.orders_count }} }); 
  
  /** Heap Identity call  **/
  // customerEmail = '{{ customer.email }}' || '{{ checkout.email }}';
  heap.identify(customerEmail);
  heap.addUserProperties({'Name': '{{ customer.name }}','email': '{{ customer.email }}' || '{{ checkout.email }}' || customerEmail,'CustomerID':'{{ customer.id }}','TotalSpent':'{{ customer.total_spent }}'});   
  /***/
                              
  /*** GTM Customer Email push   */
  window.dataLayer = window.dataLayer || [];
  window.dataLayer.push({'customerEmail': customerEmail});
{% endif %}
// End Pixel Heap

// PEBBLEPOST
// TODO: Missing pebblepost variables from checkout
window._pp = window._pp || [];
_pp.siteId = "1529";
_pp.siteUId = "{{ customer.id }}"; // Global-e said to use customer.id for {{ checkout.customer.id }}
// _pp.email = "{{ checkout.email }}" || "{{ customer.email }}"; // Grab when user enters info - grabs from globale-tracking.liquid
_pp.orderValue = cartTotalWithoutCurrency; // Grab from cart.js {{ checkout.total_price | money_without_currency }}
_pp.orderId = "{{ checkout.order_id }}"; // Global-e said not available yet
(function() {
  var ppjs = document.createElement('script');
  ppjs.type = 'text/javascript';
  ppjs.async = true;
  ppjs.src = ('https:' == document.location.protocol ? 'https:' : 'http:') +
  '//cdn.pbbl.co/r/' + _pp.siteId + '.js';
  var s = document.getElementsByTagName('script')[0];
  s.parentNode.insertBefore(ppjs, s);
})(); 

// End Pebblepost

// SteelHouse Tracking Pixel
// Install on all pages of site
(function(){"use strict";var e=null,b="4.0.0",
  n="30816",
  additional="term=value",
  t,r,i;try{t=top.document.referer!==""?encodeURIComponent(top.document.referrer.substring(0,2048)):""}catch(o){t=document.referrer!==null?document.referrer.toString().substring(0,2048):""}try{r=window&&window.top&&document.location&&window.top.location===document.location?document.location:window&&window.top&&window.top.location&&""!==window.top.location?window.top.location:document.location}catch(u){r=document.location}try{i=parent.location.href!==""?encodeURIComponent(parent.location.href.toString().substring(0,2048)):""}catch(a){try{i=r!==null?encodeURIComponent(r.toString().substring(0,2048)):""}catch(f){i=""}}var l,c=document.createElement("script"),h=null,p=document.getElementsByTagName("script"),d=Number(p.length)-1,v=document.getElementsByTagName("script")[d];if(typeof l==="undefined"){l=Math.floor(Math.random()*1e17)}h="dx.steelhousemedia.com/spx?"+"dxver="+b+"&shaid="+n+"&tdr="+t+"&plh="+i+"&cb="+l+additional;c.type="text/javascript";c.src=("https:"===document.location.protocol?"https://":"http://")+h;v.parentNode.insertBefore(c,v)})()
// End Steelhouse Tracking Pixel

// Specific to US - EU
if (window.location.href.indexOf('anine-bing-dev01-us.myshopify.com') > -1 || window.location.href.indexOf('aninebing.com') > -1) {
  // Start BounceX tag
  (function(d) {
    var e = d.createElement('script');
    e.src = d.location.protocol + '//tag.bounceexchange.com/3906/i.js';
    e.async = true;
    d.getElementsByTagName("head")[0].appendChild(e);
  }(document));
  // End BounceX tag

  // Start google adwords
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'AW-969851850');
  // End google adwords
} else {
  // Start Google Tag Manager
  // (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  // new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  // j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  // 'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  // })(window,document,'script','dataLayer','GTM-TZP79G5');
  // End Google Tag Manager

  // Start BounceX tag
  (function(d) {
    var e = d.createElement('script');
    e.src = d.location.protocol + '//tag.bounceexchange.com/3907/i.js';
    e.async = true;
    d.getElementsByTagName("head")[0].appendChild(e);
  }(document));
  // End BounceX tag

  // Start google adwords
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'AW-820623664', {'send_page_view': false});
  // End google adwords
}
